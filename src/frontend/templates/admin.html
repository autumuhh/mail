<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TempMail - Admin Panel</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/admin.css') }}">
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='resources/favicon.ico') }}">
</head>
<body>
    <!-- 主题切换按钮 -->
    <button class="theme-toggle" id="theme-toggle" title="切换主题">
        <span class="icon sun-icon">☀️</span>
        <span class="icon moon-icon">🌙</span>
    </button>
    <div class="container">
        <header class="header">
            <h1>
                <img src="{{ url_for('static', filename='resources/mail-icon.svg') }}" alt="Mail Icon">
                TempMail admin
            </h1>
            <p>IP白名单管理</p>
        </header>
<!-- Login Section -->
        <section id="login-section" class="admin-panel">
            <h2>管理员登录</h2>
            <div class="form-group">
                <label for="admin-password">管理员密码:</label>
                <input type="password" id="admin-password" placeholder="请输入管理员密码">
            </div>
            <button id="login-btn" class="btn btn-primary">登录</button>
            <button id="show-register-btn" class="btn btn-secondary">注册新用户</button>
            <div id="login-error" class="error-message"></div>
        </section>

        <!-- Register Section -->
        <section id="register-section" class="admin-panel" style="display: none;">
            <h2>用户注册</h2>
            <div class="form-group">
                <label for="register-username">用户名:</label>
                <input type="text" id="register-username" placeholder="请输入用户名">
            </div>
            <div class="form-group">
                <label for="register-email">邮箱:</label>
                <input type="email" id="register-email" placeholder="请输入邮箱地址">
            </div>
            <div class="form-group">
                <label for="register-password">密码:</label>
                <input type="password" id="register-password" placeholder="请输入密码">
            </div>
            <div class="form-group">
                <label for="register-confirm-password">确认密码:</label>
                <input type="password" id="register-confirm-password" placeholder="请再次输入密码">
            </div>
            <div class="form-group">
                <label for="register-invite-code">邀请码:</label>
                <input type="text" id="register-invite-code" placeholder="请输入邀请码">
            </div>
            <button id="register-btn" class="btn btn-primary">注册</button>
            <button id="back-to-login-btn" class="btn btn-secondary">返回登录</button>
            <div id="register-error" class="error-message"></div>
            <div id="register-success" class="success-message" style="display: none;"></div>
        </section>

        <!-- Admin Panel -->
        <section id="admin-panel" class="admin-panel" style="display: none;">
            <div class="panel-header">
                <h2>IP白名单设置</h2>
                <div class="panel-actions">
                    <div class="current-ip">
                        您的IP: <span id="current-ip">加载中...</span>
                    </div>
                    <div class="action-buttons">
                        <a href="/api-test" class="btn btn-primary">API测试</a>
                        <button id="logout-btn" class="btn btn-secondary">退出登录</button>
                    </div>
                </div>
            </div>
            <!-- Whitelist Toggle -->
            <div class="form-group">
                <label class="toggle-label">
                    <input type="checkbox" id="whitelist-enabled">
                    <span class="toggle-slider"></span>
                    启用IP白名单
                </label>
                <p class="help-text">启用后，只有白名单中的IP地址可以发送邮件和访问API</p>
            </div>
            <!-- Whitelist IPs -->
            <div class="form-group">
                <label for="whitelist-ips">允许的IP地址和网络:</label>
                <textarea id="whitelist-ips" rows="8" placeholder="127.0.0.1
::1
192.168.0.0/16
10.0.0.0/8"></textarea>
                <p class="help-text">
                    每行输入一个IP地址或CIDR网络块。<br>
                    示例: 127.0.0.1 (单个IP), 192.168.1.0/24 (网络), ::1 (IPv6)
                </p>
            </div>
            <!-- Test IP -->
            <div class="form-group">
                <label for="test-ip">测试IP地址:</label>
                <div class="test-ip-container">
                    <input type="text" id="test-ip" placeholder="输入要测试的IP地址">
                    <button id="test-ip-btn" class="btn btn-secondary">测试</button>
                </div>
                <div id="test-result" class="test-result"></div>
            </div>
            <!-- Action Buttons -->
            <div class="action-buttons">
                <button id="save-btn" class="btn btn-primary">保存设置</button>
                <button id="reload-btn" class="btn btn-secondary">重新加载</button>
            </div>
            <!-- Status Messages -->
            <div id="status-message" class="status-message"></div>
        </section>
        <!-- Quick Add Section -->
        <section id="quick-add" class="admin-panel" style="display: none;">
            <h3>快速添加常用网络</h3>
            <div class="quick-add-buttons">
                <button class="btn btn-secondary quick-add-btn" data-ip="127.0.0.1">本地主机 IPv4</button>
                <button class="btn btn-secondary quick-add-btn" data-ip="::1">本地主机 IPv6</button>
                <button class="btn btn-secondary quick-add-btn" data-ip="192.168.0.0/16">私有网络 192.168.x.x</button>
                <button class="btn btn-secondary quick-add-btn" data-ip="10.0.0.0/8">私有网络 10.x.x.x</button>
                <button class="btn btn-secondary quick-add-btn" data-ip="172.16.0.0/12">私有网络 172.16-31.x.x</button>
            </div>
        </section>
        <!-- 快捷操作区域 -->
        <section id="quick-actions" class="admin-panel" style="display: none;">
            <h3>快捷操作</h3>
            <div class="quick-actions-grid">
                <a href="/api-test" class="btn btn-primary quick-action-btn">
                    <span class="btn-icon">🧪</span>
                    <span class="btn-text">API功能测试</span>
                    <small>测试邮箱创建和邮件发送</small>
                </a>
                <a href="/" class="btn btn-secondary quick-action-btn">
                    <span class="btn-icon">📧</span>
                    <span class="btn-text">临时邮箱</span>
                    <small>生成和管理临时邮箱</small>
                </a>
            </div>
        </section>
    </div>
    <script src="{{ url_for('static', filename='scripts/theme.js') }}"></script>
    <script src="{{ url_for('static', filename='scripts/admin.js') }}"></script>
</body>
</html>
