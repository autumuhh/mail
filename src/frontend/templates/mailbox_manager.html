<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TempMail - ÈÇÆÁÆ±ÁÆ°ÁêÜ</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üìß</text></svg>">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/mailbox_manager.css') }}?v=2">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
</head>
<body>
    <div class="app-container">
        <!-- ‰æßËæπÊ†è -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-envelope-open"></i>
                    <span>TempMail</span>
                </div>
            </div>
            
            <nav class="sidebar-nav">
                <ul>
                    <li class="nav-item active" data-view="inbox">
                        <i class="fas fa-inbox"></i>
                        <span>Êî∂‰ª∂ÁÆ±</span>
                        <span class="badge" id="unread-count">0</span>
                    </li>
                    <li class="nav-item" data-view="sent">
                        <i class="fas fa-paper-plane"></i>
                        <span>Â∑≤ÂèëÈÄÅ</span>
                    </li>
                    <!-- ËÆæÁΩÆËèúÂçïÂ∑≤ÈöêËóè -->
                    <!-- <li class="nav-item" data-view="settings">
                        <i class="fas fa-cog"></i>
                        <span>ËÆæÁΩÆ</span>
                    </li> -->
                    <li class="nav-item" data-view="info">
                        <i class="fas fa-info-circle"></i>
                        <span>ÈÇÆÁÆ±‰ø°ÊÅØ</span>
                    </li>
                </ul>
            </nav>
            
            <div class="sidebar-footer">
                <button class="btn btn-theme-toggle" id="theme-toggle" onclick="toggleTheme()" title="ÂàáÊç¢‰∏ªÈ¢ò">
                    <i class="fas fa-sun theme-icon-dark"></i>
                    <i class="fas fa-moon theme-icon-light"></i>
                    <span>ÂàáÊç¢‰∏ªÈ¢ò</span>
                </button>
            </div>
        </aside>

        <!-- ‰∏ªÂÜÖÂÆπÂå∫ -->
        <main class="main-content">
            <!-- È°∂ÈÉ®Ê†è -->
            <header class="top-bar">
                <div class="mailbox-info">
                    <h1 id="mailbox-address">Âä†ËΩΩ‰∏≠...</h1>
                    <p class="mailbox-status" id="mailbox-status">Ê≠£Âú®Ëé∑ÂèñÈÇÆÁÆ±‰ø°ÊÅØ...</p>
                </div>
                
                <div class="top-actions">
                    <button class="btn btn-refresh" onclick="refreshEmails()">
                        <i class="fas fa-sync-alt"></i>
                        <span>Âà∑Êñ∞</span>
                    </button>
                    <button class="btn btn-compose" onclick="showCompose()">
                        <i class="fas fa-plus"></i>
                        <span>ÂÜôÈÇÆ‰ª∂</span>
                    </button>
                </div>
            </header>

            <!-- ÂÜÖÂÆπËßÜÂõæ -->
            <div class="content-views">
                <!-- Êî∂‰ª∂ÁÆ±ËßÜÂõæ -->
                <div class="view inbox-view active" id="inbox-view">
                    <div class="view-header">
                        <h2>
                            <i class="fas fa-inbox"></i>
                            Êî∂‰ª∂ÁÆ±
                        </h2>
                        <div class="view-actions">
                            <button class="btn btn-sm" onclick="markAllRead()">
                                <i class="fas fa-check-double"></i>
                                ÂÖ®ÈÉ®Ê†áËÆ∞Â∑≤ËØª
                            </button>
                            <button class="btn btn-sm" onclick="deleteSelected()">
                                <i class="fas fa-trash"></i>
                                Âà†Èô§ÈÄâ‰∏≠
                            </button>
                        </div>
                    </div>
                    
                    <div class="email-list-container">
                        <!-- ÈÇÆ‰ª∂ÂàóË°®Â∑•ÂÖ∑Ê†è -->
                        <div class="email-list-header">
                            <div class="email-list-info">
                                <span id="email-count">0 Â∞ÅÈÇÆ‰ª∂</span>
                            </div>
                        </div>

                        <!-- ÈÇÆ‰ª∂ÂàóË°®ÂÜÖÂÆπ -->
                        <div class="email-list" id="email-list">
                            <div class="loading-placeholder">
                                <i class="fas fa-spinner fa-spin"></i>
                                <p>Ê≠£Âú®Âø´ÈÄüÂä†ËΩΩ...</p>
                                <div style="margin-top: 1rem; font-size: 0.875rem; color: var(--text-secondary);">
                                    <p>Âπ∂Ë°åÂä†ËΩΩÈÇÆÁÆ±‰ø°ÊÅØÂíåÈÇÆ‰ª∂ÂàóË°®...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ÈÇÆ‰ª∂ËØ¶ÊÉÖËßÜÂõæ -->
                <div class="view email-detail-view" id="email-detail-view" style="display: none;">
                    <div class="email-detail-header">
                        <button class="btn btn-back" onclick="showInbox()">
                            <i class="fas fa-arrow-left"></i>
                            ËøîÂõûÊî∂‰ª∂ÁÆ±
                        </button>
                        <div class="email-actions">
                            <button class="btn btn-sm" onclick="replyEmail()">
                                <i class="fas fa-reply"></i>
                                ÂõûÂ§ç
                            </button>
                            <button class="btn btn-sm" onclick="forwardEmail()">
                                <i class="fas fa-share"></i>
                                ËΩ¨Âèë
                            </button>
                            <button class="btn btn-sm btn-danger" onclick="deleteCurrentEmail()">
                                <i class="fas fa-trash"></i>
                                Âà†Èô§
                            </button>
                        </div>
                    </div>

                    <div class="email-detail-content" id="email-detail-content">
                        <div style="display: flex; align-items: center; justify-content: center; height: 300px; color: var(--text-muted); text-align: center;">
                            <div>
                                <i class="fas fa-envelope-open" style="font-size: 4rem; margin-bottom: 1rem; color: var(--primary-color); opacity: 0.5;"></i>
                                <h3 style="margin-bottom: 0.5rem; color: var(--text-secondary);">ÈÄâÊã©ÈÇÆ‰ª∂Êü•ÁúãËØ¶ÊÉÖ</h3>
                                <p>Âú®Â∑¶‰æßÊî∂‰ª∂ÁÆ±‰∏≠ÁÇπÂáªÈÇÆ‰ª∂Êù•Êü•ÁúãÂÖ∂ÂÜÖÂÆπ</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ËÆæÁΩÆËßÜÂõæ -->
                <div class="view settings-view" id="settings-view">
                    <div class="view-header">
                        <h2>
                            <i class="fas fa-cog"></i>
                            ÈÇÆÁÆ±ËÆæÁΩÆ
                        </h2>
                    </div>
                    
                    <div class="settings-content">
                        <div class="setting-group">
                            <h3>Âèë‰ª∂‰∫∫ÁôΩÂêçÂçï</h3>
                            <p class="setting-description">Âè™Êé•Êî∂Êù•Ëá™Ëøô‰∫õÂèë‰ª∂‰∫∫ÁöÑÈÇÆ‰ª∂</p>
                            <div class="whitelist-manager">
                                <div class="whitelist-toggle">
                                    <label class="toggle-label">
                                        <input type="checkbox" id="whitelist-enabled" onchange="toggleWhitelist()">
                                        <span class="toggle-switch"></span>
                                        ÂêØÁî®ÁôΩÂêçÂçïËøáÊª§
                                    </label>
                                    <span class="toggle-status" id="whitelist-status">Â∑≤ÂÖ≥Èó≠</span>
                                </div>
                                <div class="whitelist-input" id="whitelist-input-section" style="display: none;">
                                    <input type="email" id="new-sender" placeholder="ËæìÂÖ•ÈÇÆÁÆ±Âú∞ÂùÄÊàñÂüüÂêç (Â¶Ç: @gmail.com)">
                                    <button class="btn btn-primary" onclick="addSender()">
                                        <i class="fas fa-plus"></i>
                                        Ê∑ªÂä†
                                    </button>
                                </div>
                                <div class="whitelist-items" id="whitelist-items">
                                    <!-- ÁôΩÂêçÂçïÈ°πÁõÆÂ∞ÜÂú®ËøôÈáåÂä®ÊÄÅÂä†ËΩΩ -->
                                </div>
                            </div>
                        </div>
                        
                        <div class="setting-group">
                            <h3>ÈÇÆÁÆ±‰øùÁïôÊó∂Èó¥</h3>
                            <p class="setting-description">ÈÇÆÁÆ±Â∞ÜÂú®ÊåáÂÆöÂ§©Êï∞ÂêéËá™Âä®ËøáÊúü</p>
                            <div class="retention-setting">
                                <select id="retention-days">
                                    <option value="1">1Â§©</option>
                                    <option value="3">3Â§©</option>
                                    <option value="7" selected>7Â§©</option>
                                    <option value="14">14Â§©</option>
                                    <option value="30">30Â§©</option>
                                </select>
                                <button class="btn btn-primary" onclick="updateRetention()">
                                    <i class="fas fa-save"></i>
                                    ‰øùÂ≠ò
                                </button>
                            </div>
                        </div>
                        
                        <div class="setting-group">
                            <h3>ÈÇÆÁÆ±Áä∂ÊÄÅ</h3>
                            <p class="setting-description">ÊéßÂà∂ÈÇÆÁÆ±ÁöÑÂºÄÂêØÂíåÂÖ≥Èó≠Áä∂ÊÄÅ</p>
                            <div class="mailbox-status-setting">
                                <div class="status-display">
                                    <span class="status-label">ÂΩìÂâçÁä∂ÊÄÅ:</span>
                                    <span class="status-badge" id="mailbox-status-badge">
                                        <i class="fas fa-circle"></i>
                                        <span id="mailbox-status-text">Âä†ËΩΩ‰∏≠...</span>
                                    </span>
                                </div>
                                <button class="btn" id="toggle-mailbox-btn" onclick="toggleMailboxStatus()">
                                    <i class="fas fa-toggle-on"></i>
                                    <span id="toggle-mailbox-text">ÂÖ≥Èó≠ÈÇÆÁÆ±</span>
                                </button>
                            </div>
                        </div>

                        <div class="setting-group">
                            <h3>ÂÆâÂÖ®ËÆæÁΩÆ</h3>
                            <p class="setting-description">ÁÆ°ÁêÜÊÇ®ÁöÑÈÇÆÁÆ±ËÆøÈóÆÂá≠ËØÅ</p>
                            <div class="security-actions">
                                <button class="btn btn-warning" onclick="regenerateKey()">
                                    <i class="fas fa-key"></i>
                                    ÈáçÊñ∞ÁîüÊàêÈÇÆÁÆ±ÂØÜÈí•
                                </button>
                                <button class="btn btn-info" onclick="showAccessToken()">
                                    <i class="fas fa-eye"></i>
                                    Êü•ÁúãËÆøÈóÆ‰ª§Áâå
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ÈÇÆÁÆ±‰ø°ÊÅØËßÜÂõæ -->
                <div class="view info-view" id="info-view">
                    <div class="view-header">
                        <h2>
                            <i class="fas fa-info-circle"></i>
                            ÈÇÆÁÆ±‰ø°ÊÅØ
                        </h2>
                    </div>
                    
                    <div class="info-content">
                         <div class="info-cards">
                             <div class="info-card primary-card">
                                 <div class="info-icon">
                                     <i class="fas fa-envelope"></i>
                                 </div>
                                 <div class="info-details">
                                     <h3>ÈÇÆÁÆ±Âú∞ÂùÄ</h3>
                                     <p id="info-address" class="info-value">-</p>
                                     <div class="info-actions">
                                         <button class="btn btn-sm" onclick="copyAddress()">
                                             <i class="fas fa-copy"></i>
                                             Â§çÂà∂Âú∞ÂùÄ
                                         </button>
                                         <button class="btn btn-sm btn-secondary" onclick="shareMailbox()">
                                             <i class="fas fa-share"></i>
                                             ÂàÜ‰∫´
                                         </button>
                                     </div>
                                 </div>
                             </div>

                             <div class="info-card">
                                 <div class="info-icon">
                                     <i class="fas fa-calendar-plus"></i>
                                 </div>
                                 <div class="info-details">
                                     <h3>ÂàõÂª∫Êó∂Èó¥</h3>
                                     <p id="info-created" class="info-value">-</p>
                                     <div class="info-meta">
                                         <span class="meta-label">Â∑≤‰ΩøÁî®:</span>
                                         <span id="info-usage-time" class="meta-value">-</span>
                                     </div>
                                 </div>
                             </div>

                             <div class="info-card">
                                 <div class="info-icon">
                                     <i class="fas fa-clock"></i>
                                 </div>
                                 <div class="info-details">
                                     <h3>ËøáÊúüÊó∂Èó¥</h3>
                                     <p id="info-expires" class="info-value">-</p>
                                     <div class="info-meta">
                                         <span class="meta-label">Ââ©‰ΩôÊó∂Èó¥:</span>
                                         <span id="info-remaining-time" class="meta-value">-</span>
                                     </div>
                                 </div>
                             </div>

                             <div class="info-card">
                                 <div class="info-icon">
                                     <i class="fas fa-chart-pie"></i>
                                 </div>
                                 <div class="info-details">
                                     <h3>ÈÇÆ‰ª∂ÁªüËÆ°</h3>
                                     <div class="stats-grid">
                                         <div class="stat-item">
                                             <div class="stat-number" id="info-total-emails">0</div>
                                             <div class="stat-label">ÊÄªÈÇÆ‰ª∂</div>
                                         </div>
                                         <div class="stat-item">
                                             <div class="stat-number" id="info-unread-emails">0</div>
                                             <div class="stat-label">Êú™ËØª</div>
                                         </div>
                                         <div class="stat-item">
                                             <div class="stat-number" id="info-read-emails">0</div>
                                             <div class="stat-label">Â∑≤ËØª</div>
                                         </div>
                                     </div>
                                 </div>
                             </div>

                             <div class="info-card full-width">
                                 <div class="info-icon">
                                     <i class="fas fa-shield-alt"></i>
                                 </div>
                                 <div class="info-details">
                                     <h3>ÂÆâÂÖ®Áä∂ÊÄÅ</h3>
                                     <div class="security-status">
                                         <div class="security-item">
                                             <i class="fas fa-lock"></i>
                                             <span>ËÆøÈóÆ‰ª§ÁâåÂ∑≤Âä†ÂØÜÂ≠òÂÇ®</span>
                                         </div>
                                         <div class="security-item">
                                             <i class="fas fa-user-shield"></i>
                                             <span>IPÁôΩÂêçÂçï‰øùÊä§</span>
                                         </div>
                                         <div class="security-item">
                                             <i class="fas fa-history"></i>
                                             <span>Êìç‰ΩúÊó•ÂøóËÆ∞ÂΩï</span>
                                         </div>
                                     </div>
                                 </div>
                             </div>
                         </div>

                         <div class="qr-section">
                             <div class="qr-header">
                                 <h3><i class="fas fa-qrcode"></i> ÈÇÆÁÆ±‰∫åÁª¥Á†Å</h3>
                                 <p>Êâ´Êèè‰∫åÁª¥Á†ÅÊàñ‰ΩøÁî®ÈìæÊé•Âø´ÈÄüËÆøÈóÆÊ≠§ÈÇÆÁÆ±</p>
                             </div>
                             <div class="qr-content">
                                 <div class="qr-code" id="qr-code">
                                     <!-- ‰∫åÁª¥Á†ÅÂ∞ÜÂú®ËøôÈáåÁîüÊàê -->
                                 </div>
                                 <div class="qr-info">
                                     <div class="qr-url" id="qr-url" style="word-break: break-all; font-family: monospace; font-size: 0.875rem; color: var(--text-secondary);">
                                         -
                                     </div>
                                     <button class="btn btn-sm" onclick="copyQRUrl()">
                                         <i class="fas fa-copy"></i>
                                         Â§çÂà∂ÈìæÊé•
                                     </button>
                                 </div>
                             </div>
                         </div>
                     </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Ê®°ÊÄÅÊ°Ü -->
    <div class="modal" id="compose-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ÂÜôÈÇÆ‰ª∂</h3>
                <button class="modal-close" onclick="closeCompose()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="compose-form">
                    <div class="form-group">
                        <label for="compose-to">Êî∂‰ª∂‰∫∫</label>
                        <input type="email" id="compose-to" required>
                    </div>
                    <div class="form-group">
                        <label for="compose-subject">‰∏ªÈ¢ò</label>
                        <input type="text" id="compose-subject" required>
                    </div>
                    <div class="form-group">
                        <label for="compose-body">ÂÜÖÂÆπ</label>
                        <textarea id="compose-body" rows="10" required></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeCompose()">ÂèñÊ∂à</button>
                <button class="btn btn-primary" onclick="sendEmail()">
                    <i class="fas fa-paper-plane"></i>
                    ÂèëÈÄÅ
                </button>
            </div>
        </div>
    </div>

    <!-- Toast ÈÄöÁü• -->
    <div class="toast-container" id="toast-container"></div>

    <!-- ËÆøÈóÆ‰ª§ÁâåÊ®°ÊÄÅÊ°Ü -->
    <div class="modal" id="token-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ËÆøÈóÆ‰ª§Áâå</h3>
                <button class="modal-close" onclick="closeTokenModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="token-display-section">
                    <label>ËÆøÈóÆ‰ª§Áâå:</label>
                    <div class="token-display-container">
                        <span id="token-display" class="token-display-text">-</span>
                        <button id="token-toggle-visibility" class="btn btn-sm" onclick="toggleTokenVisibility()" title="ÊòæÁ§∫‰ª§Áâå">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                <div class="token-input-section" style="display: none;">
                    <input type="password" id="token-input" readonly>
                </div>
                <div class="token-actions">
                    <button class="btn btn-primary" onclick="copyToken()">
                        <i class="fas fa-copy"></i>
                        Â§çÂà∂‰ª§Áâå
                    </button>
                    <button class="btn btn-secondary" onclick="closeTokenModal()">ÂÖ≥Èó≠</button>
                </div>
                <div class="token-info">
                    <p><i class="fas fa-info-circle"></i> ËØ∑Â¶•ÂñÑ‰øùÁÆ°ËÆøÈóÆ‰ª§ÁâåÔºå‰∏çË¶Å‰∏é‰ªñ‰∫∫ÂàÜ‰∫´</p>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='scripts/theme.js') }}?v=3"></script>
    <script src="{{ url_for('static', filename='scripts/mailbox_manager.js') }}?v=2"></script>
</body>
</html>
